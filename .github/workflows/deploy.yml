name: NVC Deployment Action

on:
  push:
    branches: [main]

jobs:
  depoly:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3
      - name: Build and deploy application container to Okteto  Namespace
        uses: addnab/docker-run-action@v3
        with:
          image: okteto/okteto:latest
          run: |
            okteto context use --token=${{ secrets.OKTETO_TOKEN }} --namespace=amjed-ali-k
            echo 'moving to ${{ env.GITHUB_WORKSPACE }}'
            ls ${{ env.GITHUB_WORKSPACE }}
            cd ${{ env.GITHUB_WORKSPACE }}
            okteto deploy --build --wait
